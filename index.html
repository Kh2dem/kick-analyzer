<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>ØªØ­Ù„ÙŠÙ„ Ù‚Ù†Ø§Ø© Kick</title>
  <style>
    body { font-family: Tahoma, sans-serif; background: #111; color: #eee; text-align: center; padding: 30px; }
    input, button { padding: 10px; font-size: 18px; margin: 10px; }
    .result { margin-top: 20px; font-size: 20px; color: #0f0; }
  </style>
</head>
<body>
  <h2>ØªØ­Ù„ÙŠÙ„ Ø¨Ø« Ù…Ù† Ù…Ù†ØµØ© ğŸ¥ Kick</h2>
  <input type="text" id="username" placeholder="Ø§Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù‚Ù†Ø§Ø©">
  <button onclick="startAuto()">ØªØ­Ù„ÙŠÙ„</button>
  <div id="result" class="result"></div>

  <script>
    let intervalId;
    let lastMessageCount = null;

    function startAuto() {
      clearInterval(intervalId);
      getKickInfo(); // Ø£ÙˆÙ„ ØªØ­Ù…ÙŠÙ„
      intervalId = setInterval(getKickInfo, 5000); // ØªØ­Ø¯ÙŠØ« ÙƒÙ„ 5 Ø«ÙˆØ§Ù†ÙŠ
    }

    async function getKickInfo() {
      const u = document.getElementById("username").value.trim().toLowerCase();
      const r = document.getElementById("result");
      if (!u) { r.innerHTML = "âš ï¸ Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù‚Ù†Ø§Ø©"; return; }

      try {
        const res = await fetch(`https://kick.com/api/v2/channels/${u}`);
        if (!res.ok) { r.innerHTML = "âŒ ÙØ´Ù„ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª"; return; }
        const d = await res.json(), L = d.livestream, C = d.chatroom;

        const viewerCount = L?.viewer_count ?? 'ØºÙŠØ± Ù…ØªÙˆÙØ±';
        const messageCount = C?.message_count ?? 'ØºÙŠØ± Ù…ØªÙˆÙØ±';

        r.innerHTML =
          `ğŸ“º Ø§Ù„Ù‚Ù†Ø§Ø©: <strong>${d.slug}</strong><br>` +
          `ğŸ¥ Ù…Ø¨Ø§Ø´Ø±: <strong>${L ? 'Ù†Ø¹Ù…' : 'Ù„Ø§'}</strong><br>` +
          `ğŸ‘¥ Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯ÙŠÙ† Ø§Ù„Ø¢Ù†: <strong>${viewerCount}</strong><br>` +
          `ğŸ’¬ Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø´Ø§Øª: <strong>${messageCount}</strong>`;

        // Ù„Ù„ØªÙØ§Ø¹Ù„: Ù†Ù‚Ø¯Ø± Ù†Ø¶ÙŠÙ ØµÙˆØª Ø£Ùˆ ØªÙ„ÙˆÙŠÙ† Ù„Ùˆ Ø²Ø§Ø¯Øª Ø§Ù„Ø±Ø³Ø§Ø¦Ù„
        if (lastMessageCount !== null && messageCount !== 'ØºÙŠØ± Ù…ØªÙˆÙØ±') {
          const diff = messageCount - lastMessageCount;
          if (diff > 0) {
            console.log(`ğŸ“¢ Ø¹Ø¯Ø¯ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø²Ø§Ø¯ Ø¨Ù€ +${diff}`);
            // ØªÙ‚Ø¯Ø± ØªØ´ØºÙ„ ØµÙˆØª Ù‡Ù†Ø§ Ø¥Ø°Ø§ ØªØ¨ÙŠ
          }
        }
        lastMessageCount = messageCount;

      } catch (e) {
        r.innerHTML = "âŒ Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØ­Ù„ÙŠÙ„";
      }
    }
  </script>
</body>
</html>
